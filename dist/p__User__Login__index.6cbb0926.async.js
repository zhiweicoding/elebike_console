(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{2067:function(te,D,e){"use strict";e.r(D);var y=e(15009),l=e.n(y),R=e(97857),f=e.n(R),S=e(99289),P=e.n(S),W=e(5574),p=e.n(W),K=e(99702),x=e(2618),F=e(87547),w=e(94149),z=e(68262),j=e(5966),O=e(28906),r=e(35312),Z=e(38925),h=e(45360),N=e(11941),$=e(67610),A=e(67294),H=e(73935),k=e(81354),B=e.n(k),s=e(85893),G=function(){var d=(0,O.l)(function(m){var c=m.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:c.borderRadius,":hover":{backgroundColor:c.colorBgTextHover}}});return(0,s.jsx)("div",{className:d,"data-lang":!0,children:r.SelectLang&&(0,s.jsx)(r.SelectLang,{})})},V=function(d){var m=d.content;return(0,s.jsx)(Z.Z,{style:{marginBottom:24},message:m,type:"error",showIcon:!0})},Q=function(){var d=(0,A.useState)({}),m=p()(d,1),c=m[0],J=(0,A.useState)("account"),U=p()(J,2),v=U[0],X=U[1],C=(0,r.useModel)("@@initialState"),M=C.initialState,Y=C.setInitialState,q=(0,O.l)(function(){return{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}),g=(0,r.useIntl)(),ee=function(){var E=P()(l()().mark(function _(){var a,o;return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,M==null||(a=M.fetchUserInfo)===null||a===void 0?void 0:a.call(M);case 2:o=i.sent,o&&(0,H.flushSync)(function(){Y(function(u){return f()(f()({},u),{},{currentUser:o})})});case 4:case"end":return i.stop()}},_)}));return function(){return E.apply(this,arguments)}}(),se=function(){var E=P()(l()().mark(function _(a){var o,t,i,u,I,b,T;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,o=a.password,o){n.next=4;break}throw new Error("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A");case 4:return t=B().MD5(o).toString(),a.timestamp=new Date().getTime(),i=B().MD5(a.username+t+a.timestamp).toString(),n.next=9,(0,x.x4)(f()(f()({},a),{},{password:t,type:v}));case 9:if(u=n.sent,!(u.msgCode===1e4&&u.msgBody)){n.next=21;break}return I=g.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),localStorage.setItem("token","Bearer ".concat(i)),h.ZP.success(I),n.next=16,ee();case 16:return b=new URL(window.location.href).searchParams,r.history.push(b.get("redirect")||"/"),n.abrupt("return");case 21:h.ZP.error(u.msgBody);case 22:n.next=29;break;case 24:n.prev=24,n.t0=n.catch(0),T=g.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(n.t0),h.ZP.error(T);case 29:case"end":return n.stop()}},_,null,[[0,24]])}));return function(a){return E.apply(this,arguments)}}(),ne=c.msgBody,ae=c.msgCode;return(0,s.jsxs)("div",{className:q,children:[(0,s.jsx)(r.Helmet,{children:(0,s.jsxs)("title",{children:[g.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",$.Z.title]})}),(0,s.jsx)(G,{}),(0,s.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,s.jsxs)(z.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,s.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"\u7BA1\u7406\u5DE5\u4F5C\u53F0",subTitle:g.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},onFinish:function(){var E=P()(l()().mark(function _(a){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,se(a);case 2:case"end":return t.stop()}},_)}));return function(_){return E.apply(this,arguments)}}(),children:[(0,s.jsx)(N.Z,{activeKey:v,onChange:X,centered:!0,items:[{key:"account",label:g.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})}]}),ne&&ae===1e4&&(0,s.jsx)(V,{content:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"}),v==="account"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Z,{name:"username",fieldProps:{size:"large",prefix:(0,s.jsx)(F.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",rules:[{required:!0,message:(0,s.jsx)(r.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,s.jsx)(j.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,s.jsx)(w.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:(0,s.jsx)(r.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]})]})}),(0,s.jsx)(K.Z,{})]})};D.default=Q},42480:function(){}}]);
